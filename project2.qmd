---
title: "Project2"
format: html
editor: visual
execute:
  warning: false
  message: false
editor_options: 
  chunk_output_type: console
---

import necessary libraries

```{r}
library(tidyverse)
library(readr)
library(jsonlite)
library(dplyr)
```

load data

```{r}
mobile_device_data <- read_csv("data/user_behavior_dataset.csv") |>
  as_tibble() |>
  rename(
    user_id = `User ID`,
    device_model = `Device Model`,
    operating_system = `Operating System`,
    app_usage_time = `App Usage Time (min/day)`,
    screen_on_time = `Screen On Time (hours/day)`,
    battery_drain = `Battery Drain (mAh/day)`,
    num_app_installed = `Number of Apps Installed`,
    data_usage = `Data Usage (MB/day)`,
    age = Age,
    gender = Gender,
    user_behavior_class = `User Behavior Class`
  )
mobile_device_data
```

```{r}
colnames(mobile_device_data)
```

create factor versions of some variables to use

```{r}
mobile_device_data <- mobile_device_data |>
mutate(across(
c(user_id, device_model, operating_system, gender, user_behavior_class),
as.factor
))

```

create a one way contingency table

```{r}
one_way_table <- mobile_device_data |>
  group_by(gender) |>
  drop_na(gender) |>
  summarize(count = n())
one_way_table
```

create a two way contingency table - comparing which operating system is used more often between males and females

```{r}

two_way_table <- mobile_device_data |>
  group_by(operating_system, gender) |>
  drop_na(operating_system, gender) |>
  summarize(count = n()) |>
  pivot_wider(names_from = gender, values_from = count, values_fill = 0)

two_way_table
```

summarize numerical variables

```{r}
mobile_device_data |>
  summarise(across(
    where(is.numeric),
    list(
      mean = mean,
      sd = sd,
      median = median,
      max = max
    ),
    .names = "{.col}.{.fn}"
  ))
```

6 plots 
barplot
```{r}
mobile_barplot <- mobile_device_data |>
  group_by(gender, operating_system) |>
  summarize(count = n(), .groups = "drop")

ggplot(mobile_barplot, aes(x = gender, y = count, fill = operating_system)) +
  geom_bar(stat = "identity", position = "dodge") +
  xlab("Gender") +
  ylab("Number of Users") +
  ggtitle("Comparison of Operating Systems by Gender") +
  scale_fill_discrete(name = "Operating System")
```

scatter plot
```{r}
ggplot(mobile_device_data, aes(x = age, y = num_app_installed, color = gender)) +
  geom_point(alpha = 0.6) +
  xlab("Age") +
  ylab("Number of Apps Installed") +
  ggtitle("Number of Installed Apps vs Age by Gender") +
  scale_color_discrete(name = "Gender") 
```

boxplot
```{r}
ggplot(mobile_device_data, aes(x = operating_system, y = num_app_installed, fill = operating_system)) +
  geom_boxplot(alpha = 0.7, outlier.color = "red", outlier.alpha = 0.6) +
  xlab("Operating System") +
  ylab("Number of Apps Installed") +
  ggtitle("Distribution of Installed Apps by Operating System") +
  scale_fill_discrete(name = "Operating System") 
```


line graph
```{r}
ggplot(mobile_device_data, aes(x = screen_on_time, y = battery_drain)) +
  geom_point(alpha = 0.6, color = "steelblue") +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  xlab("Screen-On Time (hours/day)") +
  ylab("Battery Drain (mAh/day)") +
  ggtitle("Relationship Between Screen-On Time and Battery Drain") 
```
stacked bar graoh
```{r}
# Aggregate total apps per OS and gender
mobile_device_data |>
  group_by(operating_system, gender) |>
  summarise(total_apps = sum(num_app_installed, na.rm = TRUE), .groups = "drop") |>
  ggplot(aes(x = operating_system, y = total_apps, fill = gender)) +
  geom_col(position = "dodge") +  # side-by-side bars
  labs(
    x = "Operating System",
    y = "Total Number of Apps Installed",
    fill = "Gender",
    title = "Total Apps Installed by OS and Gender"
  )
```


heat map
```{r}
mobile_device_data |>
  mutate(age_group = cut(age, breaks = c(0,20,30,40,50,60,100), right = FALSE)) |>
  group_by(age_group, operating_system) |>
  summarise(avg_screen_time = mean(screen_on_time, na.rm = TRUE), .groups = "drop") |>
  ggplot(aes(x = operating_system, y = age_group, fill = avg_screen_time)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  labs(
    x = "Operating System",
    y = "Age Group",
    fill = "Avg Screen Time (hrs/day)",
    title = "Screen Time by Age Group and Operating System"
  )
```


